# common
export DEVELOPMENT_HOME=$HOME/Development
export DEVELOPMENT_BIN=$DEVELOPMENT_HOME/bin
export DEVELOPMENT_SH=$DEVELOPMENT_HOME/sh
export HG_REPOS=$DEVELOPMENT_HOME/hg
export GIT_REPOS=$DEVELOPMENT_HOME/git
export SVN_REPOS=$DEVELOPMENT_HOME/svn

# path
MY_PATHS=(
    $HOME/bin
    $DEVELOPMENT_SH/ubuntu
    $DEVELOPMENT_SH/nix
    $DEVELOPMENT_SH/nix/git-fire
    $DEVELOPMENT_SH/nix/git-recall
    $DEVELOPMENT_SH/nix/diff-so-fancy
)

# add all directories and directories referenced by symlinks
MY_PATHS+=($(find ${HOME}/bin -maxdepth 1 ! -path ${HOME}/bin -print0 | while IFS= read -r -d $'\0' file; do
                 if [ -L "$file" ]; then
                     real_path=$(readlink $file)
                     if test -e "$real_path"; then
                         if [ -d "$real_path" ]; then
                             echo "$real_path"
                         fi
                     fi
                 else
                     if [ -d "$file" ]; then
                         echo "$file"
                     fi
                 fi
             done))

function join {
    local IFS="$1"
    shift
    echo "$*"
}

function not_in_path {
    current_path=$1
    shift
    my_paths="$@"

    i=0
    declare -a not_used=()

    for p in ${my_paths[@]}
    do
        if [[ $current_path != *$p* ]]; then
            not_used[$i]="$p"
            i=$((i + 1))
        fi
    done
    echo `join ":" "${not_used[@]}"`
}

export MY_ADDITIONAL_PATHS=`not_in_path $PATH "${MY_PATHS[@]}"`
if [ -n "$MY_ADDITIONAL_PATHS" ]; then
    export PATH=$MY_ADDITIONAL_PATHS:$PATH
fi
